# KindeAuthSwift

[![Version](https://img.shields.io/cocoapods/v/KindeAuthSwift.svg?style=flat)](https://cocoapods.org/pods/KindeAuthSwift)
[![License](https://img.shields.io/cocoapods/l/KindeAuthSwift.svg?style=flat)](https://cocoapods.org/pods/KindeAuthSwift)
[![Platform](https://img.shields.io/cocoapods/p/KindeAuthSwift.svg?style=flat)](https://cocoapods.org/pods/KindeAuthSwift)

Integrate Kinde authentication with your iOS app. Simply **configure**, **register**, **login**, and **logout**, and authentication state is securely stored on the iOS keychain across app restarts.

## Example

To run the example project, clone the repo, and run `pod install` from the Example directory first.

## Requirements

- iOS 12.4+
- Xcode 12+
- Swift 5+

## Installation

KindeAuthSwift is available through [CocoaPods](https://cocoapods.org). To install
it, simply add the following line to your Podfile:

```ruby
pod 'KindeAuthSwift'
```

Please note that `KindeAuthSwift` is typically used with Cocoapods dynamic linking (`use_frameworks!`), as it takes a dependency on `AppAuth`.
If integrating with other pods that require static linking, follow the instructions provided by Cocoapods.

## Configuration

The Kinde `Auth` service is configured with an instance of the `Config` class. The example project uses the bundled `KindeAuth.plist` for configuration.
Alternatively, configuration can be supplied in JSON format with the bundled `kinde-auth.json`.
Enter the values from the [App Keys](https://kinde.com/docs/the-basics/getting-app-keys) page for your Kinde business: E.g.,

```
{
  "issuer": "https://{your-business}.kinde.com",
  "clientId": "{your-client-id}",
  "redirectUri": "{your-url-scheme}://kinde_callback",
  "postLogoutRedirectUri": "{your-url-scheme}://kinde_logoutcallback",
  "scope": "offline openid"
}
```

Note: `your_url_scheme` can be any valid custom URL scheme, such as your app's bundle ID or an abbreviation.
It must match the scheme component of the _Allowed callback URLs_ and _Allowed logout redirect URLs_
you configure in your [App Keys](https://kinde.com/docs/the-basics/getting-app-keys) page for your Kinde business: E.g.,

```
{
  "issuer": "https://app.example.com",
  "clientId": "abc@live",
  "redirectUri": "com.example.App://kinde_callback",
  "postLogoutRedirectUri": "com.example.App://kinde_logoutcallback",
  "scope": "offline openid"
}
```

Before `Auth` or any Kinde Management APIs can be used, a call to `Auth.configure()` must be made, typically in `AppDelegate`
as part of `application(launchOptions)` for a UIKit app, or the `@main` initialization logic for a SwiftUI app.

## Kinde Management API

[Kinde Management API](./KindeAuthSwift/Classes/KindeManagementAPI/README.md)

## Development

Observe [Swift conventions](https://www.swift.org/documentation/api-design-guidelines/) where possible.

### Generate the Kinde Management API client

KindeAuthSwift includes a client for the Kinde Management API. This client is generated by the [OpenApi Genenerator](https://openapi-generator.tech/docs/generators/swift5/).
To update the client update the OpenAPI specification `kinde-mgmt-api-specs.yaml` and run the generator.

- [Install](https://classic.yarnpkg.com/en/docs/install) and run `yarn`
- Generate the API client `yarn generate-api`

Support for bearer token authentication is implemented by classes with the naming convention `Bearer`\*, according to the OpenAPI Generator [recommendation](https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-do-i-implement-bearer-token-authentication-with-urlsession-on-the-swift-api-client).

### Tests

The UI tests implemented in KindeAuthUITests require a test user to have been created for your organization.
Search for `test_user@example.com` and replace this and the associated password with the credentials of your test user.

## Author

Kinde, kinde.com

## License

KindeAuthSwift is available under the Apache-2.0 license. See the LICENSE file for more info.
